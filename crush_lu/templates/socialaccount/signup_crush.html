{% extends 'crush_lu/base.html' %}
{% load i18n %}
{% load crispy_forms_tags %}

{% block title %}Complete Your Crush.lu Signup{% endblock %}

{% block content %}
<div class="flex justify-center">
    <div class="w-full max-w-md">
        <div class="bg-white rounded-xl shadow-sm">
            <div class="p-8">
                <h2 class="text-center text-2xl font-bold mb-4">Complete Your Signup ðŸ’•</h2>
                <p class="text-center text-muted mb-4">
                    You're signing up for Crush.lu using your {{ account.provider|title }} account.
                    Please confirm your information below.
                </p>

                {% if form.errors %}
                    <div class="bg-red-50 border border-red-200 text-red-800 rounded-lg p-4 mb-4">
                        <strong>{% trans "Errors:" %}</strong>
                        <ul class="mb-0 list-disc list-inside mt-2">
                            {% for field, errors in form.errors.items %}
                                {% for error in errors %}
                                    <li>{{ field|title }}: {{ error }}</li>
                                {% endfor %}
                            {% endfor %}
                        </ul>
                    </div>
                {% endif %}

                <form class="signup" id="signup_form" method="post" action="{% url 'socialaccount_signup' %}">
                    {% csrf_token %}

                    <div class="mb-3">
                        <label for="{{ form.email.id_for_label }}" class="form-label">{% trans "Email" %}</label>
                        <input type="email"
                               class="form-control {% if form.email.errors %}is-invalid{% endif %}"
                               id="{{ form.email.id_for_label }}"
                               name="{{ form.email.name }}"
                               value="{{ form.email.value|default:'' }}"
                               readonly>
                        <small class="form-text text-muted">
                            This email is from your {{ account.provider|title }} account and cannot be changed.
                        </small>
                        {% if form.email.errors %}
                            <div class="invalid-feedback">{{ form.email.errors.0 }}</div>
                        {% endif %}
                    </div>

                    {% if redirect_field_value %}
                        <input type="hidden" name="{{ redirect_field_name }}" value="{{ redirect_field_value }}" />
                    {% endif %}

                    <div class="flex items-start gap-2 mb-4">
                        <input class="mt-1 h-4 w-4 rounded border-gray-300 text-purple-600 focus:ring-purple-500" type="checkbox" id="terms" required>
                        <label class="text-sm text-gray-600" for="terms">
                            I agree to Crush.lu's
                            <a href="{% url 'crush_lu:terms_of_service' %}" target="_blank" rel="noopener" class="text-purple-600 hover:underline">Terms of Service</a>
                            and
                            <a href="{% url 'crush_lu:privacy_policy' %}" target="_blank" rel="noopener" class="text-purple-600 hover:underline">Privacy Policy</a>
                        </label>
                    </div>

                    <button class="btn-crush-primary w-full flex items-center justify-center gap-2 py-3" type="submit">
                        {% include "crush_lu/icons/check-circle.html" with class="w-5 h-5" %}Complete Signup
                    </button>
                </form>

                <hr class="my-6 border-gray-200">

                <div class="bg-blue-50 border border-blue-200 text-blue-800 rounded-lg p-4 mb-4">
                    {% include "crush_lu/icons/information-circle.html" with class="w-5 h-5 inline mr-2" %}
                    <strong>Next Steps:</strong>
                    <ol class="mb-0 mt-2 list-decimal list-inside space-y-1">
                        <li>Complete your profile with photos and bio</li>
                        <li>Profile review by a Crush Coach</li>
                        <li>Start attending events and meeting people!</li>
                    </ol>
                </div>

                <p class="text-center text-gray-500 text-sm mb-0">
                    Already have an account?
                    <a href="{% url 'crush_lu:login' %}" class="text-purple-600 hover:underline">Login here</a>
                </p>
            </div>
        </div>
    </div>
</div>
{% endblock %}
