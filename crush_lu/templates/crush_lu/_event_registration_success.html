{% load i18n %}
<div id="registration-form-container" class="text-center py-8" role="status" aria-live="polite">
    {% if registration.status == 'waitlist' %}
        <div class="mb-4">
            {% include "shared/icons/clock.html" with class="w-16 h-16 text-yellow-500 mx-auto" %}
        </div>
        <h3 class="text-2xl font-bold mb-2">{% trans "You're on the Waitlist!" %}</h3>
        <p class="text-gray-600 dark:text-gray-300 mb-6">
            {% trans "The event is currently full, but we'll notify you if a spot opens up." %}
        </p>
    {% else %}
        <div class="mb-4">
            {% include "shared/icons/check-circle.html" with class="w-16 h-16 text-green-500 mx-auto" %}
        </div>
        <h3 class="text-2xl font-bold mb-2">{% trans "You're Registered!" %}</h3>
        <p class="text-gray-600 dark:text-gray-300 mb-6">
            {% trans "We've sent a confirmation email with all the event details." %}
        </p>
    {% endif %}

    <div class="flex flex-col gap-3">
        {% if registration.status == 'confirmed' %}
        <div class="relative" x-data="calendarDropdown" data-calendar-event-id="{{ event.id }}">
            <button @click="toggle" class="w-full inline-flex items-center justify-center gap-2 px-4 py-3 bg-gradient-to-r from-crush-purple to-crush-pink text-white hover:shadow-lg font-semibold rounded-lg transition-all duration-300">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"/>
                </svg>
                <span>{% trans "Add to Calendar" %}</span>
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
                </svg>
            </button>

            <div x-show="isOpen" @click.away="close" class="absolute left-0 right-0 mt-2 bg-white dark:bg-gray-800 rounded-lg shadow-lg dark:shadow-gray-900/20 border border-gray-200 dark:border-gray-700 py-2 z-50" style="display: none;">
                <a href="#" data-calendar-service="google" target="_blank" rel="noopener" class="flex items-center gap-3 px-4 py-2 text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">
                    <span class="text-2xl">ğŸ“—</span>
                    <span class="font-medium">{% trans "Google Calendar" %}</span>
                </a>
                <a href="#" data-calendar-service="outlook" target="_blank" rel="noopener" class="flex items-center gap-3 px-4 py-2 text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">
                    <span class="text-2xl">ğŸ“˜</span>
                    <span class="font-medium">{% trans "Outlook Calendar" %}</span>
                </a>
                <a href="#" data-calendar-service="yahoo" target="_blank" rel="noopener" class="flex items-center gap-3 px-4 py-2 text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">
                    <span class="text-2xl">ğŸ“™</span>
                    <span class="font-medium">{% trans "Yahoo Calendar" %}</span>
                </a>
                <a href="{% url 'crush_lu:event_calendar_download' event.id %}" class="flex items-center gap-3 px-4 py-2 text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">
                    <span class="text-2xl">ğŸ</span>
                    <span class="font-medium">{% trans "Apple Calendar (.ics)" %}</span>
                </a>
            </div>
        </div>
        {% include "crush_lu/partials/_add_to_calendar_js.html" %}
        {% endif %}

        <a href="{% url 'crush_lu:dashboard' %}" class="btn-crush-secondary py-3 inline-flex items-center justify-center gap-2">
            {% include "shared/icons/home.html" with class="w-4 h-4" %}
            {% trans "Go to Dashboard" %}
        </a>
        <a href="{% url 'crush_lu:event_detail' event.id %}" class="block w-full text-center py-3 px-4 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-700 font-medium rounded-lg transition-colors">
            {% trans "View Event Details" %}
        </a>
    </div>
</div>
