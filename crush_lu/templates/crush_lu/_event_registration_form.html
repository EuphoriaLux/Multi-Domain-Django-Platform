{% load i18n %}
<form method="post"
      hx-post="{% url 'crush_lu:event_register' event.id %}"
      hx-target="#registration-form-container"
      hx-swap="outerHTML"
      novalidate
      id="registration-form-container"
      aria-live="polite"
      aria-atomic="true">
    {% csrf_token %}

    {% if form.non_field_errors %}
        <div class="bg-red-50 border border-red-200 text-red-800 rounded-lg p-4 mb-4">
            {% for error in form.non_field_errors %}
                <p class="m-0">{{ error }}</p>
            {% endfor %}
        </div>
    {% endif %}

    <div class="mb-4">
        <label for="{{ form.dietary_restrictions.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-1">
            {% trans "Dietary Restrictions" %}
        </label>
        {{ form.dietary_restrictions }}
        <small class="text-gray-500 text-sm">{% trans "e.g., vegetarian, gluten-free" %}</small>
        {% if form.dietary_restrictions.errors %}
            <div class="text-red-500 text-sm mt-1">{{ form.dietary_restrictions.errors.0 }}</div>
        {% endif %}
    </div>

    <div class="mb-6">
        <label for="{{ form.special_requests.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-1">
            {% trans "Special Requests or Questions" %}
        </label>
        {{ form.special_requests }}
        {% if form.special_requests.errors %}
            <div class="text-red-500 text-sm mt-1">{{ form.special_requests.errors.0 }}</div>
        {% endif %}
    </div>

    <div class="flex flex-col gap-3">
        <button type="submit" class="btn-crush-primary py-4 text-lg inline-flex items-center justify-center gap-2">
            <span class="htmx-indicator">
                {% include "shared/icons/loading.html" with class="w-5 h-5 animate-spin" %}
            </span>
            <span class="htmx-hide-on-request">
                {% if event.is_full %}
                    {% trans "Join Waitlist" %}
                {% else %}
                    {% trans "Confirm Registration" %}
                {% endif %}
            </span>
        </button>
        <a href="{% url 'crush_lu:event_detail' event.id %}" class="block w-full text-center py-3 px-4 border border-gray-300 text-gray-700 hover:bg-gray-50 font-medium rounded-lg transition-colors">
            {% trans "Cancel" %}
        </a>
    </div>
</form>
