{% extends 'crush_lu/base.html' %}
{% load static %}
{% load i18n %}

{% block title %}{% trans "Dating Events Luxembourg - Speed Dating & Singles Meetups | Crush.lu" %}{% endblock %}

{% block og_title %}{% trans "Dating Events in Luxembourg | Crush.lu" %}{% endblock %}
{% block og_description %}{% trans "Browse upcoming speed dating events, social mixers, and singles meetups in Luxembourg. Join Crush.lu events to meet real people and make authentic connections." %}{% endblock %}

{% block twitter_title %}{% trans "Dating Events in Luxembourg | Crush.lu" %}{% endblock %}
{% block twitter_description %}{% trans "Browse upcoming speed dating events, social mixers, and singles meetups in Luxembourg. Join Crush.lu events to meet real people." %}{% endblock %}

{% block meta_description %}{% trans "Find upcoming dating events in Luxembourg. Crush.lu hosts speed dating nights, social mixers, activity meetups, and themed events for singles looking for authentic connections." %}{% endblock %}
{% block meta_keywords %}{% trans "dating events luxembourg, speed dating luxembourg, singles meetups, social mixer luxembourg, crush.lu events, luxembourg dating events" %}{% endblock %}

{% block structured_data %}
{{ block.super }}

<!-- Breadcrumb Schema -->
<script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "BreadcrumbList",
    "itemListElement": [
        {
            "@type": "ListItem",
            "position": 1,
            "name": "{% trans "Home" %}",
            "item": "https://crush.lu/"
        },
        {
            "@type": "ListItem",
            "position": 2,
            "name": "{% trans "Events" %}",
            "item": "https://crush.lu{% url 'crush_lu:event_list' %}"
        }
    ]
}
</script>

<!-- ItemList Schema for Event Collection -->
<script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "ItemList",
    "name": "{% trans "Upcoming Dating Events in Luxembourg" %}",
    "description": "{% trans "Speed dating, social mixers, and singles meetups organized by Crush.lu" %}",
    "itemListElement": [
        {% for event in events %}
        {
            "@type": "ListItem",
            "position": {{ forloop.counter }},
            "item": {
                "@type": "Event",
                "name": "{{ event.title|escapejs }}",
                "description": "{{ event.description|truncatewords:50|escapejs }}",
                "startDate": "{{ event.date_time|date:'c' }}",
                "eventStatus": "{% if event.is_cancelled %}https://schema.org/EventCancelled{% else %}https://schema.org/EventScheduled{% endif %}",
                "eventAttendanceMode": "https://schema.org/OfflineEventAttendanceMode",
                "location": {
                    "@type": "Place",
                    {% if user.is_authenticated and user_profile %}
                    "name": "{{ event.location|escapejs }}",
                    "address": {
                        "@type": "PostalAddress",
                        "streetAddress": "{{ event.address|escapejs }}",
                        "addressLocality": "{{ event.location|escapejs }}",
                        "addressCountry": "LU"
                    }
                    {% else %}
                    "name": "{{ event.canton|default:'Luxembourg'|escapejs }}",
                    "address": {
                        "@type": "PostalAddress",
                        "addressLocality": "{{ event.canton|default:'Luxembourg'|escapejs }}",
                        "addressCountry": "LU"
                    }
                    {% endif %}
                },
                "organizer": {
                    "@type": "Organization",
                    "name": "Crush.lu",
                    "url": "https://crush.lu"
                },
                "offers": {
                    "@type": "Offer",
                    "url": "https://crush.lu{% url 'crush_lu:event_detail' event.id %}",
                    "price": "{{ event.registration_fee }}",
                    "priceCurrency": "EUR",
                    "availability": "{% if event.is_full %}https://schema.org/SoldOut{% elif event.is_registration_open %}https://schema.org/InStock{% else %}https://schema.org/OutOfStock{% endif %}"
                },
                "url": "https://crush.lu{% url 'crush_lu:event_detail' event.id %}"
            }
        }{% if not forloop.last %},{% endif %}
        {% endfor %}
    ]
}
</script>
{% endblock %}

{% block extra_css %}
<!-- Styles are in static/crush_lu/css/pages/events.css -->
{% endblock %}

{% load analytics %}
{% block content %}
{# Track event list view with count in Application Insights #}
{% appinsights_event "events_page_viewed" event_count=upcoming_events|length %}
{% ga4_event "view_item_list" item_list_id="events" item_list_name="Upcoming Events" %}

{% if unpublished_count > 0 %}
<div class="bg-yellow-50 dark:bg-yellow-900/30 border border-yellow-200 dark:border-yellow-700 text-yellow-800 dark:text-yellow-300 rounded-lg p-4 mb-6 flex items-center gap-2">
    {% include "shared/icons/exclamation-triangle.html" with class="w-5 h-5" %}
    <div>
        {% blocktrans count counter=unpublished_count %}
        <strong>Coach Notice:</strong> There is {{ counter }} unpublished event that won't show here.
        {% plural %}
        <strong>Coach Notice:</strong> There are {{ counter }} unpublished events that won't show here.
        {% endblocktrans %}
        <a href="{% url 'crush_admin:crush_lu_meetupevent_changelist' %}" class="underline font-semibold hover:text-yellow-900 dark:hover:text-yellow-200">{% blocktrans count counter=unpublished_count %}Go to Admin to publish it{% plural %}Go to Admin to publish them{% endblocktrans %}</a>.
    </div>
</div>
{% endif %}

<div x-data="eventTabs">
    {# Tab navigation #}
    <div class="flex items-center gap-2 mb-6">
        <h2 class="text-2xl font-bold dark:text-white mr-4">{% trans "Events" %}</h2>
        <div class="flex bg-gray-100 dark:bg-gray-800 rounded-lg p-1 gap-1">
            <button @click="showUpcoming" x-bind:class="upcomingTabClass" class="px-4 py-2 text-sm font-medium rounded-md transition-all duration-200">
                {% trans "Upcoming" %}
            </button>
            <button @click="showPast" x-bind:class="pastTabClass" class="px-4 py-2 text-sm font-medium rounded-md transition-all duration-200">
                {% trans "Past Events" %}
            </button>
        </div>
    </div>

    {# Upcoming events tab #}
    <div x-show="isUpcoming">
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            {% for event in upcoming_events %}
                {% include "crush_lu/includes/event_card.html" with event=event is_past=False %}
            {% empty %}
            <div class="col-span-full">
                <div class="bg-white dark:bg-gray-800 rounded-xl shadow-sm dark:shadow-gray-900/20">
                    <div class="text-center py-12 px-6">
                        <h4 class="text-xl font-semibold mb-2 dark:text-white">{% trans "No events scheduled yet" %}</h4>
                        <p class="text-gray-500 dark:text-gray-400">{% trans "Check back soon for upcoming meetups and speed dating events!" %}</p>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>

    {# Past events tab #}
    <div x-show="isPast" style="display: none;">
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            {% for event in past_events %}
                {% include "crush_lu/includes/event_card.html" with event=event is_past=True %}
            {% empty %}
            <div class="col-span-full">
                <div class="bg-white dark:bg-gray-800 rounded-xl shadow-sm dark:shadow-gray-900/20">
                    <div class="text-center py-12 px-6">
                        <h4 class="text-xl font-semibold mb-2 dark:text-white">{% trans "No past events yet" %}</h4>
                        <p class="text-gray-500 dark:text-gray-400">{% trans "Past events will appear here after they've taken place." %}</p>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
</div>
{% endblock %}
