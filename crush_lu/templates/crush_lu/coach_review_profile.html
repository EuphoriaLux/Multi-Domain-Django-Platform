{% extends 'crush_lu/base.html' %}

{% block title %}Review Profile - Crush.lu{% endblock %}

{% block content %}
<div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
    <div class="lg:col-span-2">
        <a href="{% url 'crush_lu:coach_dashboard' %}" class="inline-flex items-center gap-2 px-4 py-2 mb-4 border border-gray-300 text-gray-700 hover:bg-gray-50 font-medium rounded-lg transition-colors">
            {% include "shared/icons/arrow-left.html" with class="w-4 h-4" %}
            Back to Dashboard
        </a>

        <div class="bg-white rounded-xl shadow-sm mb-6">
            <div class="px-6 py-4 border-b border-gray-100">
                <h4 class="font-semibold mb-0">Profile Review</h4>
            </div>
            <div class="p-6">
                <h5 class="text-xl font-semibold">{{ profile.user.get_full_name }}</h5>
                <p class="text-gray-500">{{ profile.user.email }}</p>

                <hr class="my-4 border-gray-200">

                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                    <div>
                        <p><strong>Age:</strong> {% if profile.age %}{{ profile.age }}{% else %}Not set{% endif %} {% if profile.date_of_birth %}({{ profile.date_of_birth }}){% endif %}</p>
                        <p><strong>Gender:</strong> {{ profile.get_gender_display|default:"Not set" }}</p>
                        <p><strong>Location:</strong> {{ profile.location|default:"Not set" }}</p>
                    </div>
                    <div>
                        <p><strong>Phone:</strong> {{ profile.phone_number|default:"Not provided" }}</p>
                        <p><strong>Looking for:</strong> {{ profile.get_looking_for_display }}</p>
                    </div>
                </div>

                <hr class="my-4 border-gray-200">

                <h6 class="font-semibold mb-2">Bio</h6>
                <p class="text-gray-600 mb-4">{{ profile.bio }}</p>

                <h6 class="font-semibold mb-2">Interests</h6>
                <p class="text-gray-600 mb-4">{{ profile.interests }}</p>

                <hr class="my-4 border-gray-200">

                <h6 class="font-semibold mb-2">Privacy Settings</h6>
                <ul class="list-disc list-inside text-gray-600 mb-4">
                    <li>Show full name: {% if profile.show_full_name %}Yes{% else %}No{% endif %}</li>
                    <li>Show exact age: {% if profile.show_exact_age %}Yes{% else %}No{% endif %}</li>
                    <li>Blur photos: {% if profile.blur_photos %}Yes{% else %}No{% endif %}</li>
                </ul>

                <hr class="my-4 border-gray-200">

                <h6 class="font-semibold mb-3">Photos</h6>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    {% if profile.photo_1 %}
                        <div>
                            <img src="{{ profile.photo_1.url }}" class="w-full rounded-lg" alt="Photo 1" loading="lazy">
                        </div>
                    {% endif %}
                    {% if profile.photo_2 %}
                        <div>
                            <img src="{{ profile.photo_2.url }}" class="w-full rounded-lg" alt="Photo 2" loading="lazy">
                        </div>
                    {% endif %}
                    {% if profile.photo_3 %}
                        <div>
                            <img src="{{ profile.photo_3.url }}" class="w-full rounded-lg" alt="Photo 3" loading="lazy">
                        </div>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>

    <div class="lg:col-span-1">
        <!-- Screening Call Status (HTMX-powered) -->
        {% include 'crush_lu/_screening_call_section.html' %}

        <!-- Review Decision -->
        <div class="bg-white rounded-xl shadow-sm mb-4">
            <div class="px-6 py-4 border-b border-gray-100">
                <h5 class="font-semibold mb-0">Review Decision</h5>
            </div>
            <div class="p-6">
                <form method="post">
                    {% csrf_token %}

                    <div class="mb-4">
                        <label for="{{ form.status.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-1">Decision *</label>
                        {{ form.status }}
                    </div>

                    <div class="mb-4">
                        <label for="{{ form.coach_notes.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-1">
                            Internal Notes (not visible to user)
                        </label>
                        {{ form.coach_notes }}
                    </div>

                    <div class="mb-4">
                        <label for="{{ form.feedback_to_user.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-1">
                            Feedback to User (visible if rejected/revision)
                        </label>
                        {{ form.feedback_to_user }}
                    </div>

                    <button type="submit" class="btn-crush-primary w-full py-3">
                        Submit Review
                    </button>
                </form>
            </div>
        </div>

        <div class="bg-white rounded-xl shadow-sm">
            <div class="p-6">
                <h6 class="font-semibold mb-2">Review Guidelines</h6>
                <ul class="text-sm text-gray-600 list-disc list-inside space-y-1">
                    <li><strong>Complete screening call first!</strong></li>
                    <li>Check for appropriate content</li>
                    <li>Verify photos are clear and appropriate</li>
                    <li>Ensure bio is genuine and respectful</li>
                    <li>Confirm age verification (18+)</li>
                    <li>Look for red flags or suspicious content</li>
                </ul>
            </div>
        </div>
    </div>
</div>
{% endblock %}
