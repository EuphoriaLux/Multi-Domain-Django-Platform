{% extends 'crush_lu/base.html' %}
{% load static i18n %}

{% block title %}{% trans "Request Connection" %}{% endblock %}

{% block content %}
<div class="py-10">
    <div class="max-w-lg mx-auto">
        <!-- Header -->
        <div class="text-center mb-6">
            <h1 class="text-3xl font-bold text-gray-900 mb-3">{% trans "Request Connection ðŸ’•" %}</h1>
            <p class="text-gray-500">{{ event.title }}</p>
        </div>

        <!-- Profile Card -->
        <div class="bg-white rounded-xl shadow-lg mb-6 overflow-hidden">
            <div class="text-center py-8 px-6">
                {% if recipient.crushprofile.photo_1 %}
                    <img src="{{ recipient.crushprofile.photo_1.url }}"
                         alt="{{ recipient.crushprofile.display_name }}"
                         class="w-28 h-28 rounded-full object-cover mx-auto mb-4 {% if recipient.crushprofile.blur_photos %}blur-lg{% endif %}"
                         loading="lazy">
                {% else %}
                    <div class="w-28 h-28 rounded-full bg-gradient-to-br from-purple-500 to-pink-500 inline-flex items-center justify-center mx-auto mb-4">
                        <span class="text-white text-4xl font-semibold">{{ recipient.crushprofile.display_name|first }}</span>
                    </div>
                {% endif %}

                <h3 class="text-xl font-semibold text-gray-900 mb-1">{{ recipient.crushprofile.display_name }}</h3>
                <p class="text-gray-500 mb-4">{{ recipient.crushprofile.age_display }}</p>

                {% if recipient.crushprofile.interests %}
                    <div class="mb-2">
                        <span class="text-sm text-gray-500">
                            {% include "shared/icons/star.html" with class="w-5 h-5" %} {{ recipient.crushprofile.interests }}
                        </span>
                    </div>
                {% endif %}
            </div>
        </div>

        <!-- Connection Request Form -->
        <div class="bg-white rounded-xl shadow-lg overflow-hidden">
            <div class="p-6">
                <h5 class="text-lg font-semibold text-gray-900 mb-3">Add a note (optional)</h5>
                <p class="text-sm text-gray-500 mb-6">
                    Help {{ recipient.crushprofile.display_name }} remember your conversation!
                    This will be visible to your Crush Coach.
                </p>

                <form method="post">
                    {% csrf_token %}

                    <div class="mb-6">
                        <label for="note" class="block text-sm font-medium text-gray-700 mb-1">What did you talk about?</label>
                        <textarea class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500"
                                  id="note"
                                  name="note"
                                  rows="4"
                                  placeholder="We talked about hiking in Mullerthal..."
                                  maxlength="500"></textarea>
                        <p class="text-sm text-gray-500 mt-1">Optional - helps jog their memory</p>
                    </div>

                    <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6">
                        <h6 class="font-medium text-blue-800 mb-2">{% include "shared/icons/information-circle.html" with class="w-5 h-5" %} What happens next?</h6>
                        <ul class="text-sm text-blue-700 space-y-1 list-disc list-inside">
                            <li>{{ recipient.crushprofile.display_name }} will be notified of your request</li>
                            <li>If they accept (or already requested you!), a Crush Coach will facilitate</li>
                            <li>You'll both need to consent before contact info is shared</li>
                        </ul>
                    </div>

                    <div class="flex flex-col gap-3">
                        <button type="submit" class="btn-crush-primary w-full py-3 text-lg font-semibold">
                            {% include "shared/icons/heart.html" with class="w-5 h-5" %} Send Connection Request
                        </button>
                        <a href="{% url 'crush_lu:event_attendees' event.id %}"
                           class="w-full py-3 px-6 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 text-center font-medium transition-colors">
                            Cancel
                        </a>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
{% endblock %}
