{% load i18n %}
<div id="connection-actions-{{ attendee.user.id }}" role="status" aria-live="polite">
    {% if attendee.connection_status == 'sent' %}
        <span class="inline-flex items-center gap-1 px-2.5 py-1 text-sm font-semibold bg-purple-100 text-purple-800 rounded-full">
            {% include "shared/icons/check-circle.html" with class="w-3 h-3" %}
            {% trans "Request Sent" %}
        </span>
    {% elif attendee.connection_status == 'received' %}
        <div class="flex gap-2">
            <button hx-post="{% url 'crush_lu:respond_connection' attendee.connection_id 'accept' %}"
                    hx-target="#connection-actions-{{ attendee.user.id }}"
                    hx-swap="outerHTML"
                    class="inline-flex items-center gap-1 px-3 py-1.5 text-sm font-semibold bg-green-500 hover:bg-green-600 text-white rounded-lg transition-colors">
                <span class="htmx-indicator">
                    {% include "shared/icons/loading.html" with class="w-4 h-4 animate-spin" %}
                </span>
                <span class="htmx-hide-on-request inline-flex items-center gap-1">
                    {% include "shared/icons/check-circle.html" with class="w-4 h-4" %}
                    {% trans "Accept" %}
                </span>
            </button>
            <button hx-post="{% url 'crush_lu:respond_connection' attendee.connection_id 'decline' %}"
                    hx-target="#connection-actions-{{ attendee.user.id }}"
                    hx-swap="outerHTML"
                    hx-confirm="{% trans 'Are you sure you want to decline this connection?' %}"
                    class="inline-flex items-center gap-1 px-3 py-1.5 text-sm font-medium border border-gray-300 text-gray-700 hover:bg-gray-50 rounded-lg transition-colors">
                <span class="htmx-indicator">
                    {% include "shared/icons/loading.html" with class="w-4 h-4 animate-spin" %}
                </span>
                <span class="htmx-hide-on-request">
                    {% trans "Decline" %}
                </span>
            </button>
        </div>
    {% elif attendee.connection_status == 'mutual' %}
        <span class="inline-flex items-center gap-1 px-2.5 py-1 text-sm font-semibold bg-green-100 text-green-800 rounded-full">
            {% include "shared/icons/heart.html" with class="w-3 h-3" %}
            {% trans "Connected!" %}
        </span>
    {% else %}
        <button hx-get="{% url 'crush_lu:request_connection_inline' event.id attendee.user.id %}"
                hx-target="#connection-actions-{{ attendee.user.id }}"
                hx-swap="outerHTML"
                class="btn-crush-primary inline-flex items-center gap-1 px-3 py-1.5 text-sm">
            <span class="htmx-indicator">
                {% include "shared/icons/loading.html" with class="w-4 h-4 animate-spin" %}
            </span>
            <span class="htmx-hide-on-request inline-flex items-center gap-1">
                {% include "shared/icons/heart.html" with class="w-4 h-4" %}
                {% trans "Request Connection" %}
            </span>
        </button>
    {% endif %}
</div>
