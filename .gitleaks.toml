# Gitleaks configuration
# https://github.com/gitleaks/gitleaks

[extend]
useDefault = true

# Allowlist for false positives - Azure RBAC role IDs are public GUIDs
[allowlist]
description = "Allow Azure RBAC role definitions, documentation examples, test fixtures, and development defaults"
paths = [
  '''infra/keyvault\.bicep''',
  '''azure-functions/.*/README\.md''',
  '''scripts/.*\.py''',
  '''.*/migrations/.*\.py''',  # Django migrations with blank=True defaults
  '''.*/tests/.*\.py''',       # Test fixtures and sample data
  '''SECURITY_ALERT_.*\.md''', # Security documentation
  '''.*views_webhook\.py''',   # Webhook documentation in docstrings
]
regexes = [
  # Key Vault Secrets User role ID (public Azure RBAC GUID)
  '''4633458b-17de-408a-b874-0445c86b69e6''',

  # Azurite default development key (public Microsoft-documented value)
  # https://learn.microsoft.com/en-us/azure/storage/common/storage-use-azurite
  '''Eby8vdM02xNOcqFlqUwJPLlmEtlCDXJ1OUzFT50uSRZ6IFsuFq2UVErCz4I6tq/K1SZFPTOtr/KBHBeksoGMGw==''',

  # Documentation placeholder tokens
  '''YOUR_SECRET_TOKEN''',
  '''YOUR_ADMIN_API_KEY''',
  '''your-admin-api-key''',
  '''your_secret_token_here''',

  # Test fixture placeholders (Web Push p256dh keys)
  '''blank=True.*help_text=.*token''',
  '''p256dh_key=.*test.*''',
]
